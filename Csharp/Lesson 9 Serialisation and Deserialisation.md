# Тема урока: Сериализация и десериализация

## Какую проблему решает данная тема ?

Одной из самых главных проблем с самого начала программирования являлась проблема хранения данных. Во врем предыдущих предметов вы работали с .txt файлами или .bin файлами, но это не удобно.

Но многие путают сериализацию и десериализацию с сохранением данных в файлы. Сериализация и десериализация - это процесс преобразования объектов в формат, который может быть сохранен или передан, а затем восстановлен обратно в объект. Хранение - это всего лишь удобный бонус.

## Что такое сериализация и десериализация ?

`Сериализация` - это процесс преобразования объекта в формат, который может быть сохранен или передан. путем потокового преобразования объекта в последовательность байтов

`Десериализация` - это обратный процесс, при котором сериализованный объект восстанавливается обратно в исходный объект.

## Типы сериализации

- `Binary`
- `XML`
- `JSON`
- `YAML`
- `Protocol Buffers`

**Binary** - это тривиальный метод сериализации, который преобразует объекты в последовательность байтов. Он эффективен по скорости и размеру, но не читабелен для человека. Даже если вы откроете такой файл и измените символ который вам понятен, то файл испортится с огромной вероятностью.

Пример .bin файла:

```
00000000  01 00 00 00 02 00 00 00  03 00 00 00 04 00 00 00  |................|
00000010  05 00 00 00 06 00 00 00  07 00 00 00 08 00 00 00  |................|
```

То есть для человека такой формат нечитабелен и его нельзя отредактировать. Но для компьютера это очень удобный формат, так как он занимает мало места и быстро обрабатывается. Также из минусов то, что в C# при такой сериализации в файл записывается уникальные метаданные именно вашей операционной системы, что делает невозможным прочитать такой файл на другом компьютере или в другой операционной системе. Но просто для пример я вам покажу как это работает.

**XML** - это текстовый формат, который используется для хранения и передачи данных. Он читабелен для человека и может быть легко обработан различными программами. XML позволяет создавать сложные структуры данных, но занимает больше места по сравнению с бинарной сериализацией. Он очень обширно используется в веб-разработке и обмене данными между различными системами. К примеру протокол `SOAP` использует XML для обмена данными между веб-сервисами. Но в наши дни данный метод сериализации уже не так популярен и в новых проектах его практически не используют.

**JSON** - это легковесный текстовый формат, который используется для обмена данными между клиентом и сервером. Он читабелен для человека, легко читается и записывается, а также поддерживается большинством языков программирования. JSON является более компактным по сравнению с XML и часто используется в веб-разработке для передачи данных между клиентом и сервером. Он явяется стандартом для обмена данными в RESTful API. С названия **JavaScript Object Notation** можно понять, что он инзачально был разработан для JS, но так как именно этот язые является стандартом для браузеров, то он очень быстро распространился и на другие языки программирования.

**YAML** - это текстовые формат который используется для сериализации данных в разных DevOps интсрументах, например в `Kubernetes`. Точно так же есть и `YML` - это просто сокращение от `YAML`. Он читабелен для человека и позволяет создавать сложные структуры данных. YAML часто используется в конфигурационных файлах и для обмена данными между различными системами. Он более удобен для чтения человеком по сравнению с JSON, но менее популярен в веб-разработке.

**Protocol Buffers** - современный бинарный формат сериализации для обмена данными между система в основном используется в микросервисной архитектуре. Его самая знаменитая версия - это протокол `gRPC`, созданный компанией Google.

Последние два метода мы будем проходить с вами в будущих предметах, так как они более сложные и требуют отдельного изучения.


## Newtonsoft.Json

Сс самого начала жизни .NET, а именно еще со времен Framework, в .NET не было встроенной библиотеки для работы с JSON. Поэтому разработчики использовали сторонние библиотеки, такие как `Newtonsoft.Json`, которая стала де-факто стандартом для работы с JSON в .NET. Если вы посмотрите на количество скачиваний этой библиотеки в NuGet, то увидите, что она была скачана более 1 миллиарда раз. Это говорит о том, что библиотека очень популярна и широко используется в .NET экосистеме.


В .NET 5 и выше появилась встроенная библиотека `System.Text.Json`, которая позволяет работать с JSON без использования сторонних библиотек. Но `Newtonsoft.Json` все еще остается популярной и используется во многих проектах, так как она более функциональна и удобна в использовании.

Но после появляение в нем не было всех тех возможностей, которые были в `Newtonsoft.Json`, поэтому многие разработчики продолжают использовать эту библиотеку. К примеру там не было такого как `JsonSerializerSettings`, в котором вы можете настроить форматирование, игнорирование свойств и т.д. 

Одним их самых главных плюсов было рекурсивное сериализация объектов, то есть вы можете сериализовать объекты, которые содержат другие объекты. Это очень удобно, так как вам не нужно вручную сериализовать каждый объект. Со временем в .NET 6 и выше `System.Text.Json` добавил поддержку рекурсивной сериализации, и уже считается полноценной заменой `Newtonsoft.Json`. Но многие разработчики все еще используют `Newtonsoft.Json`, так как она удобная и привычная для многих. Вы должны знать про эту библиотеку, так как много проектов уже были написаны с ее использованием, и вам придется с ней работать.

    
